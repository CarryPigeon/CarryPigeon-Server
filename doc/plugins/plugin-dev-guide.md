# 插件开发指南

> 本文提供“从 0 到可上线”的最小开发路径。

## 1. 开发前准备

- 阅读：`plugin-architecture.md`、`plugin-api-reference.md`
- 明确插件类型：拓展性 / 侵入性
- 明确目标链路：影响哪个 `api_*` chain

## 2. 最小开发流程

1. 在插件模块中声明 Spring 组件
2. 若为拓展性插件，新增 LiteFlow 节点
3. 将节点插入目标 chain（`api_*.xml`）
4. 增加配置开关（默认关闭，灰度启用）
5. 增加日志与异常处理
6. 补充测试与回滚方案

## 3. 节点开发规范

- 入参校验放在节点开头
- 读写上下文使用统一 key 常量
- 业务失败使用统一错误模型
- 非关键增强逻辑建议“失败降级 + 记录日志”

## 4. 侵入性插件规范

- 仅替换 `api` 定义的抽象接口
- 保持与默认实现一致的错误语义
- 对性能与事务边界进行专项验证

## 5. 上线清单

- [ ] 配置开关可控（可快速关闭）
- [ ] 关键日志可定位问题
- [ ] 压测通过（核心路径无明显退化）
- [ ] 回滚路径明确（切回默认实现）
