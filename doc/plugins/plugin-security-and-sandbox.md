# 插件安全与沙箱指南

> 目标：确保插件可扩展但不越权，避免对宿主系统与数据造成不可控风险。

## 1. 最小权限原则

- 插件只申请业务必需权限
- 默认拒绝高风险能力（任意网络、任意文件系统、反射注入等）
- 插件对宿主内部实现保持“黑盒依赖”

## 2. 依赖边界

- 只依赖 `api` 稳定接口与必要公共库
- 禁止直接依赖宿主内部实现包
- 禁止绕过宿主鉴权与错误模型

## 3. 数据与隐私

- 插件不得持久化明文敏感信息
- 插件日志需脱敏，禁止输出 token/密钥
- 插件缓存与临时数据应可清理、可隔离

## 4. 网络与外部调用

- 外部调用需明确超时、重试与熔断
- 建议限制可访问目标（域名/IP 白名单）
- 不允许无界重试造成级联故障

## 5. 供应链安全

- 插件包需校验来源与完整性
- 建议启用签名校验或白名单机制
- 升级前进行兼容性与安全扫描

## 6. 应急策略

- 必须具备插件级禁用开关
- 出现异常时优先降级并保核心链路可用
- 保留版本回滚能力与操作审计
