<?xml version="1.0" encoding="UTF-8"?>
<flow>
    <!--创建频道请求-->
    <chain name="/core/channel/create">
        THEN(
        /**判断用户是否登录**/
        UserLoginChecker,
        /**重命名参数**/
        RenameArg.bind("RenameArg","SessionId:UserInfo_Id"),
        /**查询用户**/
        CPUserSelector.bind("key","id"),
        /**创建频道信息**/
        CPChannelCreator,
        /**创建用户信息**/
        CPChannelMemberCreator,
        /**重设用户权限**/
        CPChannelMemberAuthoritySetter.bind("key","admin"),
        /**保存**/
        CPChannelSaver,CPChannelMemberSaver
        )
    </chain>
    <!--删除频道请求-->
    <chain name="/core/channel/delete">
        THEN(
        /**判断用户是否登录**/
        UserLoginChecker,
        /**重命名参数**/
        RenameArg.bind("RenameArg","SessionId:UserInfo_Id"),
        /**查询频道**/
        CPChannelSelector.bind("key","id"),
        /**权限校验**/
        CPChannelOwnerChecker,
        /**获取频道成员通知表**/
        CPChannelMemberCollector,
        /**删除频道**/
        CPChannelDeleter,
        /**通知所有人**/
        CPNotifier.bind("route","/core/channel/list")
        )
    </chain>
    <!--获取用户的所有频道请求-->
    <chain name="/core/channel/list">
        THEN(
        /**判断用户是否登录**/
        UserLoginChecker,
        /**重命名参数**/
        RenameArg.bind("RenameArg","SessionId:UserInfo_Id"),
        /**获取用户所有频道**/
        CPChannelMemberCollector
        )
    </chain>
    <!--获取频道数据-->
    <chain name="/core/channel/profile/get">
        THEN(
        /**判断用户是否登录**/
        UserLoginChecker,
        /**获取频道信息**/
        CPChannelSelector.bind("key","id")
        )
    </chain>
    <!--更新频道数据-->
    <chain name="/core/channel/profile/update">
        THEN(
        /**判断用户是否登录**/
        UserLoginChecker,
        /**重命名参数**/
        RenameArg.bind("RenameArg","SessionId:UserInfo_Id"),
        /**获取频道信息**/
        CPChannelSelector.bind("key","id"),
        /**权限校验**/
        CPChannelOwnerChecker,
        /**更新频道信息**/
        CPChannelUpdater,
        /**保存**/
        CPChannelSaver,
        /**获取成员信息**/
        CPChannelMemberCollector,
        /**通知所有人**/
        CPNotifier.bind("route","/core/channel/list")
        )
    </chain>
</flow>