<flow>
    <!--创建入群申请-->
    <chain name="/core/channel/application/create">
        THEN(
        /**判断用户是否登录**/
        UserLoginChecker,
        /**获取通道信息**/
        CPChannelSelector.bind("key","id"),
        /**创建申请**/
        CPChannelApplicationCreator,
        /**保存申请**/
        CPChannelApplicationSavor,
        /**获取所有管理员**/
        CPChannelAdminCollector,
        /**通知管理员**/
        CPNotifier.bind("route","/core/channel/application/list")
        )
    </chain>
    <!--处理申请-->
    <chain name="/core/channel/application/process">
        THEN(
        /**判断用户是否登录**/
        UserLoginChecker,
        /**重命名用户信息**/
        RenameArg.bind("key","UserInfo_Id:SessionId"),
        /**获取申请信息**/
        CPChannelApplicationSelector.bind("key","id"),
        /**获取通道id信息**/
        CPChannelApplicationCidGetter,
        /**重命名数据**/
        RenameArg.bind("key","ChannelInfo_Id:ChannelApplicationInfo_Cid"),
        /**判断是否为管理员**/
        CPChannelAdminChecker,
        /**处理申请**/
        SWITCH(ChannelApplicationStateSetterSwitcher).to(
            THEN(
                CPChannelApplicationApproved,
                CPChannelMemberSaver
            ).tag("approved"),
            THEN(
                DoNothing
            ).tag("rejected")
        ),
        /**保存**/
        CPChannelApplicationSavor,
        /**获取群组信息**/
        CPChannelSelector.bind("key","id"),
        /**获取所有管理员**/
        CPChannelAdminCollector,
        /**通知管理员**/
        CPNotifier.bind("route","/core/channel/application/list"),
        /**清理参数**/
        CleanerArg.bind("key","Notifier_Uids"),
        /**获取所有用户**/
        CPChannelMemberCollector,
        /**通知所有用户**/
        CPNotifier.bind("route","/core/channel/member/list")
        )
    </chain>
    <!--获取申请列表-->
    <chain name="/core/channel/application/list">
        THEN(
        /**检查用户是否登录**/
        UserLoginChecker,
        /**重命名参数**/
        RenameArg.bind("key","UserInfo_Id:SessionId"),
        /**判断是否为管理员**/
        CPChannelAdminChecker,
        /**获取申请列表**/
        CPChannelApplicationLister
        )
    </chain>
</flow>
